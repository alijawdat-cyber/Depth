# ðŸ” Ø³ÙŠØ§Ø³Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ (Key Management Policy) - Depth V2.0

## 1. Ø§Ù„Ù†Ø·Ø§Ù‚
ØªØ´Ù…Ù„: Ù…ÙØ§ØªÙŠØ­ APIØŒ Ø£Ø³Ø±Ø§Ø± WebhooksØŒ Ø±Ù…ÙˆØ² Ø§Ù„Ø®Ø¯Ù…Ø©ØŒ Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØ´ÙÙŠØ±ØŒ ØªÙˆÙƒÙ†Ø§Øª Ø§Ù„Ù†Ø´Ø±.

## 2. Ø§Ù„Ù…Ø¨Ø§Ø¯Ø¦
- Ø£Ù‚Ù„ ØµÙ„Ø§Ø­ÙŠØ© (Least Privilege)
- ÙØµÙ„ Ø§Ù„Ø¨ÙŠØ¦Ø§Øª (Isolation)
- Ø¯ÙˆØ±Ø§Ù† Ø¯ÙˆØ±ÙŠ (Rotation)
- ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ®Ø²ÙŠÙ† ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ (No Inline Secrets)

## 3. Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…ÙØ§ØªÙŠØ­
| Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… | Ø§Ù„ØªØ®Ø²ÙŠÙ† | Ø§Ù„Ø¯ÙˆØ±Ø§Ù† | Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© |
|-------|----------|---------|---------|----------|
| Firebase Admin Key | ÙˆØ¸Ø§Ø¦Ù Ø³ÙŠØ±ÙØ± | Vercel / Secret Manager (Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹) | Ù†ØµÙ Ø³Ù†ÙˆÙŠ | Logs Ø§Ù„ÙˆØµÙˆÙ„ |
| Vercel Token | Ù†Ø´Ø± | GitHub Secrets | Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ | Ù…Ø±Ø§Ø¬Ø¹Ø© PR |
| Webhook Signing Secret | ØªØ­Ù‚Ù‚ Ø³Ù„Ø§Ù…Ø© | Firestore (Ù…Ø´ÙØ±) | Ø¹Ù†Ø¯ Ø§Ù„Ø´Ùƒ / Ø³Ù†ÙˆÙŠ | Ø¹Ø¯ ÙØ´Ù„ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ |
| Encryption Key (AES-256) | ØªØ´ÙÙŠØ± Ø­Ù‚ÙˆÙ„ Ø­Ø³Ø§Ø³Ø© | KMS Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹ / Ù…ØªØºÙŠØ± Ù…Ø¨Ø¯Ø¦ÙŠ | Ø³Ù†ÙˆÙŠ | Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… | 
| Service Account JSON | ØªÙØ§Ø¹Ù„ Ø®Ù„ÙÙŠ | Encrypted Secret | Ù†ØµÙ Ø³Ù†ÙˆÙŠ | ÙˆØµÙˆÙ„ ÙˆØ¸ÙŠÙÙŠ |

## 4. Ø¯ÙˆØ±Ø© Ø­ÙŠØ§Ø© Ø§Ù„Ø³Ø± (Secret Lifecycle)
1. Ø¥Ù†Ø´Ø§Ø¡ (Generate)
2. ØªÙˆØ²ÙŠØ¹ Ø¢Ù…Ù† (Store & Scope)
3. Ø§Ø³ØªØ®Ø¯Ø§Ù… (Access Logging)
4. Ø¯ÙˆØ±Ø§Ù† (Rotate)
5. Ø¥Ø¨Ø·Ø§Ù„ (Revoke)
6. Ø¥Ø²Ø§Ù„Ø© (Dispose Securely)

## 5. Ø§Ù„ØªÙˆÙ„ÙŠØ¯ (Generation)
Ø§Ø³ØªØ®Ø¯Ø§Ù… `openssl rand -hex 32` Ø£Ùˆ Ø£Ø¯ÙˆØ§Øª Ø±Ø³Ù…ÙŠØ© (Console) â€” ÙŠÙ…Ù†Ø¹ Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙƒÙ„Ù…Ø§Øª Ù…Ø±ÙˆØ± Ø¨Ø´Ø±ÙŠØ©.

## 6. Ø§Ù„Ø¯ÙˆØ±Ø§Ù† (Rotation Procedure)
| Ø®Ø·ÙˆØ© | ÙˆØµÙ |
|------|-----|
| 1 | ØªÙˆÙ„ÙŠØ¯ Ù‚ÙŠÙ…Ø© Ø¬Ø¯ÙŠØ¯Ø© |
| 2 | Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ù…Ø®Ø²Ù† Ø§Ù„Ø£Ø³Ø±Ø§Ø± (Ù„Ø§ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù…Ø¨Ø§Ø´Ø± Ø¨Ø¹Ø¯) |
| 3 | ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙƒÙˆÙŠÙ† ÙÙŠ Staging ÙˆØ§Ø®ØªØ¨Ø§Ø± |
| 4 | ØªØ¨Ø¯ÙŠÙ„ Production |
| 5 | Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¨Ø¹Ø¯ 24 Ø³Ø§Ø¹Ø© (Grace) |
| 6 | ØªØ­Ø¯ÙŠØ« Ø³Ø¬Ù„ Ø§Ù„Ø¯ÙˆØ±Ø§Ù† |

## 7. Ø³Ø¬Ù„ Ø§Ù„Ø¯ÙˆØ±Ø§Ù† (Rotation Log)
Ø­Ù‚Ù„ Ù…Ù‚ØªØ±Ø­ ÙÙŠ Firestore: `keyRotations/{id}`
```
{
  id, keyType, oldFingerprint, newFingerprint, rotatedBy, rotatedAt, graceEndsAt
}
```

## 8. Ø¨ØµÙ…Ø§Øª (Fingerprints)
Ø­ÙØ¸ Ø¨ØµÙ…Ø© SHA256 Ù„Ù„Ù…ÙØªØ§Ø­ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ù‚ÙŠÙ…ØªÙ‡ ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù…Ø±Ø¬Ø¹ ÙˆØ§Ù„ØªØ­Ù‚Ù‚.

## 9. Ø§Ù„ÙˆØµÙˆÙ„ (Access Control)
| Ø§Ù„Ø¯ÙˆØ± | Ø§Ù„Ø³Ù…Ø§Ø­ | Ø§Ù„Ù‚ÙŠÙˆØ¯ |
|-------|--------|--------|
| Admin | Ù‚Ø±Ø§Ø¡Ø©/Ø¥Ø¯Ø§Ø±Ø© | Ø¹Ø¨Ø± Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø¢Ù…Ù†Ø© |
| Developer | Ù‚Ø±Ø§Ø¡Ø© Ù…ÙØ§ØªÙŠØ­ Dev ÙÙ‚Ø· | Ù„Ø§ ÙˆØµÙˆÙ„ Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ |
| Auditor | Ù‚Ø±Ø§Ø¡Ø© Ø¨ØµÙ…Ø§Øª ÙˆØ³Ø¬Ù„Ø§Øª | Ø¨Ù„Ø§ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù‚ÙŠÙ… |

## 10. Ø§Ù„Ù…Ø®Ø§Ø·Ø± ÙˆØ§Ù„ØªØ®ÙÙŠÙ
| Ø§Ù„Ø®Ø·Ø± | Ø§Ù„Ø£Ø«Ø± | Ø§Ù„ØªØ®ÙÙŠÙ |
|-------|-------|---------|
| ØªØ³Ø±Ø¨ Ù…ÙØªØ§Ø­ Ø¥Ù†ØªØ§Ø¬ | Ø§Ø®ØªØ±Ø§Ù‚ Ø¨ÙŠØ§Ù†Ø§Øª | ØªØ´ÙÙŠØ± + Ø¯ÙˆØ±Ø§Ù† Ø³Ø±ÙŠØ¹ |
| Ù…Ø´Ø§Ø±ÙƒØ© Ù…ÙØ§ØªÙŠØ­ | ØµØ¹ÙˆØ¨Ø© ØªØªØ¨Ø¹ | ÙØµÙ„ Ù„ÙƒÙ„ Ø®Ø¯Ù…Ø© |
| Ù…ÙØ§ØªÙŠØ­ Ù‚Ø¯ÙŠÙ…Ø© | Ø«ØºØ±Ø§Øª | Ø³ÙŠØ§Ø³Ø© Ø¯ÙˆØ±Ø§Ù† Ø¢Ù„ÙŠØ© |

## 11. Ø§Ù„Ø£ØªÙ…ØªØ© Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©
- [ ] Ø§Ø¹ØªÙ…Ø§Ø¯ Managed KMS
- [ ] ØªÙ†Ø¨ÙŠÙ‡ Slack Ø¹Ù†Ø¯ Ø§Ù‚ØªØ±Ø§Ø¨ Ù…ÙˆØ¹Ø¯ Ø¯ÙˆØ±Ø§Ù†
- [ ] ÙØ­Øµ Secrets ÙÙŠ PR (GitLeaks)

## 12. Ø¹Ø¯Ù… Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…
Ø£ÙŠ ØªØ¬Ø§ÙˆØ² ÙŠØ±ÙØ¹ Ø¥Ù„Ù‰ Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø£Ù…Ù† ÙˆÙŠÙÙˆØ«Ù‚ ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø®Ø§Ø·Ø±.

> Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: 2025-08-21
