# ๐ ุชูุฑูุฑ ุชุญููู ูุดุงูู ููุญุฉ ุงูุฅุฏุงุฑุฉ

## ๐ ููุฎุต ุงููุดุงูู ุงูููุชุดูุฉ:

### ๐จ ุงููุดููุฉ ุงูุฃุณุงุณูุฉ: ุชุญุฏูุฏ ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช

#### 1๏ธโฃ **ูุดููุฉ ูู ุงูุชุญูู ูู ุตูุงุญูุงุช ุงูุฃุฏูู**
```typescript
// โ ูุดููุฉ: ูุชุญูู ูู session.user.role ุจุฏูู ุงูุชุฃูุฏ ูู ูุฌูุฏู
if (session.user.role !== 'admin') {
  return NextResponse.json({ error: 'ุบูุฑ ูุณููุญ' }, { status: 403 });
}
```

**ุงููููุงุช ุงููุชุฃุซุฑุฉ:**
- `/api/admin/users/route.ts` (ุฎุท 41)
- `/api/admin/security/stats/route.ts` (ุฎุท 19)  
- `/api/admin/projects/route.ts` (ุฎุท 26, 182)
- `/api/admin/projects/[id]/approve/route.ts` (ุฎุท 48)
- `/api/admin/projects/[id]/deliverables/route.ts` (ุฎุท 68)
- `/api/admin/projects/[id]/send-quote/route.ts` (ุฎุท 61)
- `/api/admin/users/[id]/status/route.ts` (ุฎุท 37, 144)

#### 2๏ธโฃ **ูุดููุฉ ูู ุฏุงูุฉ determineUserRole**
```typescript
// โ ูุดููุฉ: ุงูุจุญุซ ูู creators ูุณุชุฎุฏู ููุทูู ูุฎุชูููู
const creatorSnap = await adminDb
  .collection('creators')
  .where('contact.email', '==', emailLower)  // ููุท ูุฏูู
  .limit(1)
  .get();

const creatorTop = await adminDb
  .collection('creators')
  .where('email', '==', emailLower)  // ููุท ุฌุฏูุฏ
  .limit(1)
  .get();
```

#### 3๏ธโฃ **ูุดููุฉ ูู ุงูุชูุงูู ูุน ุงููุธุงู ุงูููุญุฏ**
ุงููุธุงู ูุญุงูู ุงุณุชุฎุฏุงู ูุฌููุนุฉ `users` ุงูููุญุฏุฉ ููู ูุนูุฏ ูููุฌููุนุงุช ุงููููุตูุฉ ูุงุญุชูุงุทูุ ููู ุงูุจูุงูุงุช ูุฏ ุชููู ุบูุฑ ูุชุฒุงููุฉ.

### ๐ฅ ุชุฃุซูุฑ ุงููุดุงูู:

1. **ุตูุญุฉ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู**: ูุดู ูู ุงูุชุญููู ูุฃู `session.user.role` ุบูุฑ ูุญุฏุฏ
2. **ุตูุญุฉ ุงููุชุงููุฌ**: ุชุนูู ูููุณุชุฎุฏููู ุงูุนุงุฏููู ููู ุชูุดู ููุฃุฏูู
3. **ุตูุญุฉ ุงูุฃูุงู**: ูุดู ุชุงู ูู ุงูุชุญููู
4. **ุตูุญุงุช ุงููุดุงุฑูุน**: ูุดู ูู ุงูุนูููุงุช ุงูุฅุฏุงุฑูุฉ

### ๐๏ธ ุงูุญููู ุงูููุชุฑุญุฉ:

#### ุงูุญู 1: ุชุญุณูู ุงูุชุญูู ูู ุตูุงุญูุงุช ุงูุฃุฏูู
```typescript
// โ ุญู ูุญุณู
const userRole = session.user.role || await determineUserRole(session.user.email);
if (userRole !== 'admin') {
  return NextResponse.json({ error: 'ุบูุฑ ูุณููุญ' }, { status: 403 });
}
```

#### ุงูุญู 2: ุชุญุณูู ุฏุงูุฉ determineUserRole
- ุฅุฒุงูุฉ ุงูุชูุฑุงุฑ ูู ุงูุจุญุซ ุนู creators
- ุชุญุณูู ุชุฑุชูุจ ุงูุจุญุซ
- ุฅุถุงูุฉ logging ููุชุดุฎูุต

#### ุงูุญู 3: ุฅุถุงูุฉ middleware ููุชุญูู ูู ุตูุงุญูุงุช ุงูุฃุฏูู
ุฅูุดุงุก ุฏุงูุฉ ูุณุงุนุฏุฉ ููุญุฏุฉ ููุชุญูู ูู ุตูุงุญูุงุช ุงูุฃุฏูู.

### ๐ ุฎุทุฉ ุงูุฅุตูุงุญ:

1. **ูุฑุญูุฉ 1**: ุฅุตูุงุญ ููุฑู ููุชุญูู ูู ุงูุตูุงุญูุงุช
2. **ูุฑุญูุฉ 2**: ุชุญุณูู ุฏุงูุฉ determineUserRole  
3. **ูุฑุญูุฉ 3**: ุฅูุดุงุก middleware ููุญุฏ
4. **ูุฑุญูุฉ 4**: ุงุฎุชุจุงุฑ ุดุงูู ูุฌููุน APIs

### ๐ฏ ุงูุชุญูู ูู ุงูุฅุตูุงุญ:

- [ ] ุตูุญุฉ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ุชุญููู ุจูุฌุงุญ
- [ ] ุตูุญุฉ ุงููุชุงููุฌ ุชุนูู ููุฃุฏูู
- [ ] ุตูุญุฉ ุงูุฃูุงู ุชุนุฑุถ ุงูุฅุญุตุงุฆูุงุช
- [ ] ุฌููุน ุงูุนูููุงุช ุงูุฅุฏุงุฑูุฉ ุชุนูู ุจุดูู ุตุญูุญ

---

**ุชู ุฅูุดุงุก ูุฐุง ุงูุชูุฑูุฑ ูู:** ${new Date().toISOString()}
**ุจูุงุณุทุฉ:** ุชุญููู ุดุงูู ููููุงุช ุงููุธุงู
